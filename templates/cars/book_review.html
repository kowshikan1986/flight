{% extends "base.html" %}

{% block title %}Review Van Hire - WanderWise{% endblock %}

{% block extra_head %}
<style>
    body {
        background: #F5F3F0;
    }
    .primary-btn {
        background-color: #4A5568;
        transition: background-color 0.3s ease;
    }
    .primary-btn:hover {
        background-color: #2D3748;
    }
    .flow-card {
        background: #ffffff;
        border-radius: 1rem;
        box-shadow: 0 25px 50px -12px rgba(148, 163, 184, 0.35);
        border: 1px solid rgba(148, 163, 184, 0.2);
    }
</style>
{% endblock %}

{% block content %}
<div class="py-6 space-y-8">
    <div>
        <a href="{% url 'cars:book' car.id %}" class="inline-flex items-center text-gray-600 hover:text-gray-900 mb-4">
            <i class="fas fa-arrow-left mr-2"></i>Edit hire details
        </a>
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Review your van hire</h1>
        <p class="text-gray-600">{{ car.company }} {{ car.model }} &middot; {{ car.category }}</p>
    </div>

    <div class="grid lg:grid-cols-3 gap-8">
        <div class="lg:col-span-2 space-y-6">
            <section class="flow-card p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Hire details</h2>
                <div class="space-y-3 text-gray-700 text-sm">
                    <div class="flex items-center"><i class="fas fa-location-dot w-5 mr-2 text-gray-500"></i><span>Pick-up location: {{ booking_summary.pickup_location }}</span></div>
                    <div class="flex items-center"><i class="fas fa-flag-checkered w-5 mr-2 text-gray-500"></i><span>Drop-off location: {{ booking_summary.dropoff_location|default:booking_summary.pickup_location }}</span></div>
                    <div class="flex items-center"><i class="fas fa-calendar-day w-5 mr-2 text-gray-500"></i><span>Pick-up date: {{ booking_summary.pickup_date|date:"M d, Y" }}</span></div>
                    {% if booking_summary.pickup_time %}
                        <div class="flex items-center"><i class="fas fa-clock w-5 mr-2 text-gray-500"></i><span>Pick-up time: {{ booking_summary.pickup_time|time:"g:i A" }}</span></div>
                    {% endif %}
                    <div class="flex items-center"><i class="fas fa-road w-5 mr-2 text-gray-500"></i><span>Duration: {{ booking_summary.duration_days }} day{{ booking_summary.duration_days|pluralize }}</span></div>
                    {% if booking_summary.pickup_address %}
                        <div class="flex items-start"><i class="fas fa-map-signs w-5 mr-2 text-gray-500 mt-1"></i><span>Pick-up address: {{ booking_summary.pickup_address }}</span></div>
                    {% endif %}
                </div>
            </section>

            <section class="flow-card p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Lead guest & contact</h2>
                <div class="space-y-2 text-gray-700 text-sm">
                    <p><span class="font-semibold">Name:</span> {{ booking_summary.first_name }} {{ booking_summary.last_name }}</p>
                    {% if booking_summary.contact_number %}
                        <p><span class="font-semibold">Contact number:</span> {{ booking_summary.contact_number }}</p>
                    {% endif %}
                    <p><span class="font-semibold">Email:</span> {{ booking_summary.contact_email }}</p>
                </div>
                <div class="mt-4 bg-blue-50 border border-blue-100 text-blue-800 text-sm rounded-lg p-4 flex items-start">
                    <i class="fas fa-lock mr-2 mt-0.5"></i>
                    <span>No payment has been taken yet. You'll confirm card details on the next secure step.</span>
                </div>
            </section>

            <form method="post" class="flow-card p-6 space-y-4">
                {% csrf_token %}
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600">Amount due on payment step</p>
                        <p class="text-xs text-gray-500">Includes trip rate and applicable fees</p>
                    </div>
                    <p class="text-xl font-semibold text-gray-900">${{ booking_summary.estimated_total|floatformat:2 }} <span class="text-sm text-gray-500">{{ booking_summary.currency_code }}</span></p>
                </div>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div>
                        <h2 class="text-xl font-semibold text-gray-800">Ready to pay?</h2>
                        <p class="text-sm text-gray-600">You can still go back and update hire details before confirming.</p>
                    </div>
                    <button type="submit" class="primary-btn text-white font-bold py-3 px-6 rounded-lg hover:shadow-lg transition-all">
                        Proceed to payment <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </form>
        </div>

        <aside class="flow-card p-6 sticky top-24 space-y-4">
            <h3 class="text-lg font-semibold text-gray-800">Trip summary</h3>
            <div class="border-b border-gray-200 pb-4">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start">
                        <div class="bg-green-100 p-2 rounded-lg mr-3 flex-shrink-0">
                            <i class="fas fa-van-shuttle text-green-600"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">{{ car.company }} {{ car.model }}</h4>
                            <p class="text-sm text-gray-600">{{ car.category }}</p>
                            <p class="text-xs text-gray-500">{{ booking_summary.pickup_location }} → {{ booking_summary.dropoff_location|default:booking_summary.pickup_location }}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-xl font-semibold text-gray-900">${{ booking_summary.estimated_total|floatformat:2 }}</p>
                        <p class="text-xs text-gray-500">{{ booking_summary.currency_code }}</p>
                    </div>
                </div>
            </div>
            <div class="space-y-2 text-sm text-gray-600">
                <p class="flex justify-between"><span>Pick-up:</span><span>{{ booking_summary.pickup_date|date:"M d, Y" }}{% if booking_summary.pickup_time %} · {{ booking_summary.pickup_time|time:"g:i A" }}{% endif %}</span></p>
                <p class="flex justify-between"><span>Duration:</span><span>{{ booking_summary.duration_days }} day{{ booking_summary.duration_days|pluralize }}</span></p>
                <p class="flex justify-between"><span>Seats:</span><span>{{ car.seats }}</span></p>
                {% if car.luggage_capacity %}
                    <p class="flex justify-between"><span>Luggage capacity:</span><span>{{ car.luggage_capacity }}</span></p>
                {% endif %}
                <p class="flex justify-between font-semibold text-gray-800"><span>Estimated total:</span><span>${{ booking_summary.estimated_total|floatformat:2 }}</span></p>
                <p class="text-xs text-gray-500">Final amount confirmed on payment.</p>
            </div>
        </aside>
    </div>
</div>
{% endblock %}
